<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- No fallback meta tags for title or description -->
    <meta property="og:image" content="https://www.manuplast.co/images/logo.png" />
    <meta property="og:url" content="https://www.manuplast.co/type-detail.html" />
    <meta property="og:type" content="product" />
    <meta property="og:site_name" content="manuplast" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="https://www.manuplast.co/images/logo.png" />
    <title></title>
    <link href="style.css" rel="stylesheet" />
    <link rel="icon" type="image/png" href="./images/logo.png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Inline script to pre-fetch meta tags synchronously, prioritized for crawlers
      (function () {
        const params = new URLSearchParams(window.location.search);
        const typeId = params.get("id");
        const categoryId = params.get("category_id");

        if (typeId && categoryId) {
          // Quick fetch with shorter timeout
          fetch(
            `https://api.vybtek.com/api/manuplast/producttypes/${typeId}`,
            {
              headers: {
                Authorization: `Bearer ${localStorage.getItem("token") || ""}`,
              },
              timeout: 2000, // Reduced to 2 seconds for faster execution
            }
          )
            .then((response) => {
              if (!response.ok) throw new Error("Network response was not ok");
              return response.json();
            })
            .then((product) => {
              const truncateDescription = (desc, maxLength = 160) => {
                if (!desc || typeof desc !== "string") return "";
                const cleanDesc = desc.replace(/\r\n/g, " ").trim();
                if (cleanDesc.length <= maxLength) return cleanDesc;
                const truncated = cleanDesc.substring(0, maxLength);
                return truncated.substring(0, truncated.lastIndexOf(" ")) + "...";
              };

              const descriptionText = truncateDescription(product.description);
              document.title = product.name ? `${product.name} - Manuplast` : "";
              const metaDescription = document.querySelector('meta[name="description"]');
              if (!metaDescription) {
                const newMeta = document.createElement("meta");
                newMeta.name = "description";
                newMeta.content = descriptionText;
                document.head.appendChild(newMeta);
              } else {
                metaDescription.setAttribute("content", descriptionText);
              }

              const ogTitle = document.querySelector('meta[property="og:title"]');
              if (!ogTitle) {
                const newOgTitle = document.createElement("meta");
                newOgTitle.setAttribute("property", "og:title");
                newOgTitle.setAttribute(
                  "content",
                  product.name ? `${product.name} - manuplast` : ""
                );
                document.head.appendChild(newOgTitle);
              } else {
                ogTitle.setAttribute(
                  "content",
                  product.name ? `${product.name} - manuplast` : ""
                );
              }

              const ogDescription = document.querySelector('meta[property="og:description"]');
              if (!ogDescription) {
                const newOgDesc = document.createElement("meta");
                newOgDesc.setAttribute("property", "og:description");
                newOgDesc.setAttribute("content", descriptionText);
                document.head.appendChild(newOgDesc);
              } else {
                ogDescription.setAttribute("content", descriptionText);
              }

              document
                .querySelector('meta[property="og:image"]')
                ?.setAttribute(
                  "content",
                  product.cover_image_url ||
                    "https://www.manuplast.co/images/logo.png"
                );
              document
                .querySelector('meta[property="og:url"]')
                ?.setAttribute("content", window.location.href);

              const twitterTitle = document.querySelector('meta[name="twitter:title"]');
              if (!twitterTitle) {
                const newTwitterTitle = document.createElement("meta");
                newTwitterTitle.setAttribute("name", "twitter:title");
                newTwitterTitle.setAttribute(
                  "content",
                  product.name ? `${product.name} - manuplast` : ""
                );
                document.head.appendChild(newTwitterTitle);
              } else {
                twitterTitle.setAttribute(
                  "content",
                  product.name ? `${product.name} - manuplast` : ""
                );
              }

              const twitterDescription = document.querySelector('meta[name="twitter:description"]');
              if (!twitterDescription) {
                const newTwitterDesc = document.createElement("meta");
                newTwitterDesc.setAttribute("name", "twitter:description");
                newTwitterDesc.setAttribute("content", descriptionText);
                document.head.appendChild(newTwitterDesc);
              } else {
                twitterDescription.setAttribute("content", descriptionText);
              }

              document
                .querySelector('meta[name="twitter:image"]')
                ?.setAttribute(
                  "content",
                  product.cover_image_url ||
                    "https://www.manuplast.co/images/logo.png"
                );

              const schemaScript = document.querySelector(
                'script[type="application/ld+json"]'
              );
              if (schemaScript && product.name) {
                const schemaData = {
                  "@context": "https://schema.org",
                  "@type": "Product",
                  name: product.name || "",
                  image:
                    product.cover_image_url ||
                    "https://www.manuplast.co/images/logo.png",
                  description: descriptionText || "",
                  sku: product.id || "PRODUCT123",
                  mpn: product.id || "MPN123",
                  brand: { "@type": "Brand", name: "manuplast" },
                  offers: {
                    "@type": "Offer",
                    url: window.location.href,
                    priceCurrency: "INR",
                    price: product.price
                      ? parseFloat(product.price.replace(/[^\d.]/g, ""))
                      : "0.00",
                    priceValidUntil: "2026-07-22",
                    availability:
                      product.status === "active"
                        ? "https://schema.org/InStock"
                        : "https://schema.org/OutOfStock",
                    seller: { "@type": "Organization", name: "manuplast" },
                  },
                };
                schemaScript.textContent = JSON.stringify(schemaData, null, 2);
              }
            })
            .catch((error) => {
              console.error("Pre-fetch error:", error);
            });
        }
      })();
    </script>
    <script src="headerFooter.js"></script>
    <script src="products.js"></script>
    <script defer src="whatsapp.js"></script>
    <style>
      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .sticky {
        position: sticky;
        top: 20px;
      }
      .thumbnail:hover {
        transform: scale(1.1);
        transition: transform 0.3s ease;
      }
      .color-swatch:hover {
        transform: scale(1.1);
        transition: transform 0.3s ease;
      }
      .tab-active {
        border-bottom: 2px solid #3b82f6;
        color: #3b82f6;
      }
      @media (max-width: 640px) {
        .related-product-card {
          width: 100%;
          max-width: 300px;
          margin-left: auto;
          margin-right: auto;
        }
        .related-products-grid {
          display: flex;
          flex-direction: column;
          align-items: center;
        }
      }
    </style>
  </head>

  <body>
    <!-- Header -->
    <special-header></special-header>

    <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div id="type-detail" class="text-center"></div>
    </section>

    <!-- Footer -->
    <special-footer></special-footer>
  </body>
</html>